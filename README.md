# blog_automatic_posting

쿠팡 파트너스 상품을 자동으로 수집하고, OpenAI GPT를 활용해 글을 생성한 뒤 **티스토리에 자동 발행**해 주는 윈도우용 GUI 프로그램입니다.
---

## 기능 요약

- **GUI 기반 설정**
  - 쿠팡 파트너스 아이디 / 비밀번호
  - 티스토리 아이디 / 비밀번호
  - 쿠팡 검색어
  - 글쓰기 페이지 URL
  - 생성할 글 개수
  - OpenAI API 키
  - 완료 후 컴퓨터 자동 종료 옵션(향후 기능)

- **쿠팡 파트너스 자동화**
  - 쿠팡 파트너스 로그인 자동 진행
  - 입력한 검색어로 상품 검색
  - 상위 N개 상품에 대해:
    - **파트너스 상품 링크(축약 URL) 추출**
    - 상품 대표 이미지 URL 수집
    - 베스트 리뷰 텍스트 수집
    - 상품 제목 수집

- **엑셀 저장 및 전처리**
  - `C:\blog_automatic_posting\blog_automatic_posting.xlsx` 파일 생성
  - 컬럼 구조:
    - A열: `item_link`
    - B열: `img_src`
    - C열: `best_review`
    - D열: `title`
  - `title`의 **앞 8글자 기준으로 중복 상품 제거** (색상/옵션만 다른 동일 상품 제거용)

- **OpenAI GPT를 활용한 글 자동 생성**
  - 모델: `gpt-4o-mini`
  - 각 상품에 대해:
    1. 베스트 리뷰를 참고해 **20자 미만의 부제목 2개 생성**
    2. 각 부제목에 대해 리뷰를 참고한 **약 400자 이내의 단락** 2개 생성
    3. `부제목 + 내용` 형식으로 구성된 본문을 하나의 문자열로 합쳐 엑셀에 저장

- **티스토리 자동 포스팅**
  - 티스토리(카카오 계정) 자동 로그인
  - 지정한 글쓰기 페이지 URL로 이동
  - 제목 자동 작성
    - 예: `쿠팡 가성비 {검색어} 추천{상품명}`
  - 본문에 고정 문구 + 쿠팡 파트너스 링크 자동 삽입
    - `이 포스팅은 쿠팡 파트너스 활동의 일환으로, 이에 따른 일정액의 수수료를 제공받습니다.`
  - GPT로 생성한 부제목/내용을 티스토리 에디터에 HTML 형식으로 삽입
  - 발행 옵션 및 공개 설정 후 자동 발행

---

## 동작 흐름

1. GUI에서 설정 값 입력
2. **시작 버튼 클릭**
3. 쿠팡 파트너스 로그인
4. 검색어 기준으로 상위 N개 상품 링크 수집
5. 각 상품의 이미지 / 베스트 리뷰 / 제목 수집
6. 엑셀 파일 생성 및 중복 상품 제거
7. OpenAI GPT를 통해 부제목 + 본문 생성
8. 티스토리 로그인 및 글쓰기 페이지 접속
9. 쿠팡 링크 + 본문을 포함한 포스팅 자동 발행
10. (향후) 완료 후 컴퓨터 자동 종료 옵션 처리

---

## 사용 환경

- OS: **Windows**
  - 엑셀 파일 경로가 `C:\blog_automatic_posting\blog_automatic_posting.xlsx`로 고정되어 있습니다.
  - `shutdown` 명령 사용(`test.py` 포함)으로 보아 Windows 기준입니다.
- Python: 3.9 이상 권장
- 브라우저: Chrome
  - `chromedriver`가 PATH에 있거나, `webdriver.Chrome()`이 정상적으로 실행 가능한 환경

---

## 의존 라이브러리

`requirements.txt`가 별도로 정의되어 있지 않으므로, 아래 패키지를 수동 설치해야 합니다.

```bash
pip install PyQt5 selenium fake-useragent openpyxl openai pyperclip
